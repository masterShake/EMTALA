<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<title>EMTALA_Chap10_rebuild</title>
		<link href="css/idGeneratedStyles.css" rel="stylesheet" type="text/css" />
	</head>
	<body id="EMTALA_Chap10_rebuild" lang="en-US">
		<div id="_idContainer000" class="Basic-Text-Frame">
			<p class="Master-Pages_Chapter-Head ParaOverride-1"><span class="Chapter-number"><a id="_idTextAnchor000"></a></span><span class="Chapter-number">10</span> <span class="CharOverride-1">Required Signage</span> </p>
		</div>
		<div id="_idContainer001" class="_idGenObjectStyleOverride-1">
			<p class="TOC_TOC-Level-1"><a href="l#_idTextAnchor002">I.&#9;Overview</a></p>
			<p class="TOC_TOC-Level-1"><a href="#_idTextAnchor003">II.&#9;Requirements</a></p>
			<p class="TOC_TOC-Level-1"><a href="#_idTextAnchor005">III.&#9;Posters About Opioids and Pain Management</a></p>
		</div>
		<div id="_idContainer002" class="Basic-Text-Frame">
			<p class="Master-Pages_Chapter-Head ParaOverride-1"><span class="Chapter-number"><a id="_idTextAnchor001"></a></span><span class="Chapter-number">10</span> <span class="CharOverride-1">Required Signage</span> </p>
		</div>
		<div id="_idContainer003" class="_idGenObjectStyleOverride-1">
			<ol>
				<li class="Body-Styles_Header-1"><a id="_idTextAnchor002"></a>Overview<p class="Body-Styles_Body-Text _idGenParaOverride-1"><a id="_idIndexMarker000"></a><a id="_idIndexMarker001"></a>Hospitals must post conspicuous signs in the dedicated emergency department (on- and off- campus) and other places in which emergency patients may present (such as the entrance, waiting rooms, admitting area and treatment rooms). These signs must state the rights of individuals under EMTALA to examination and treatment for emergency medical conditions and women in labor, and whether the hospital participates in the Medicaid program. Posting of signs is not required in off-campus departments that are not dedicated emergency departments.</p></li>
				<li class="Body-Styles_Header-1"><a id="_idTextAnchor003"></a>Requirements<p class="Body-Styles_Body-Text _idGenParaOverride-1">The Centers for Medicare &amp; Medicaid Services (CMS) has listed the following requirements for EMTALA signage <span class="Italic">(see extract from the preamble to the 1994 EMTALA regulations at the end of this chapter)</span>:</p><ol><li class="Body-Styles_Numbered-List _idGenParaOverride-2">Signs must specify the rights of unstable individuals with emergency conditions and women in labor who come to the dedicated emergency department for health care services;</li><li class="Body-Styles_Numbered-List _idGenParaOverride-2">Signs must indicate whether the facility participates in the Medicaid program;</li><li class="Body-Styles_Numbered-List _idGenParaOverride-2">The wording of the signs must be clear and in simple terms understandable by the population served;</li><li class="Body-Styles_Numbered-List _idGenParaOverride-2">Signs must be printed in English and other major languages that are common to the population of the hospital service area;</li><li class="Body-Styles_Numbered-List _idGenParaOverride-2">The letters within the signs must be clearly readable at a distance of at least 20 feet, or from the expected vantage point of dedicated emergency department patrons; and</li><li class="Body-Styles_Numbered-List _idGenParaOverride-2">Signage must be posted in a place or places likely to be noticed by all individuals entering the dedicated emergency department, as well as those individuals waiting for examination and treatment (e.g., entrance, admitting area, waiting room, treatment area).</li></ol></li>
			</ol>
			<p class="Body-Styles_Body-Text">Some states have adopted additional requirements for signage relating to emergency care. For example, California law requires that signs list the name, address and telephone number of the district office of the California Department of Public Health, Licensing and Certification Division.</p>
			<p class="Body-Styles_Body-Text">In the preamble to the final 1994 EMTALA regulations, CMS suggested the following model language for the EMTALA signage <span class="Italic">(see extract from 1994 EMTALA regulations on </span><a href="EMTALA_Chap10_rebuild.html#_idTextAnchor004"><span class="Italic">page </span><span class="Italic">10.3</span></a><span class="Italic">)</span>:</p>
			<p class="Body-Styles_Body-Text ParaOverride-2"><span class="CharOverride-2">It’s the Law!</span></p>
			<p class="Body-Styles_Body-Text ParaOverride-2"><span class="CharOverride-2">If You Have a Medical Emergency or Are in Labor</span></p>
			<p class="Body-Styles_Body-Text ParaOverride-3">You have the right to receive, within the capabilities of this hospital’s staff and facilities:</p>
			<ul>
				<li class="Body-Styles_Bullet-List ParaOverride-4">An appropriate medical screening examination;</li>
				<li class="Body-Styles_Bullet-List ParaOverride-4">Necessary stabilizing treatment (including treatment for an unborn child);</li>
				<li class="Body-Styles_Bullet-List ParaOverride-4">And, if necessary, an appropriate transfer to another facility even if you cannot pay, you do not have medical insurance or you are not entitled to Medicare or Medicaid.</li>
			</ul>
			<p class="Body-Styles_Body-Text ParaOverride-3">This hospital [doe<span class="No-break">s/d</span>oes not] participate in the Medicaid program.</p>
			<p class="Body-Styles_Body-Text ParaOverride-3">[Add local address and telephone number for the district office of the Department of Public Health, Licensing and Certification.]</p>
			<p class="Body-Styles_Body-Text ParaOverride-5">Hospitals are permitted to add other information to the signs. However, signs or other information that are viewed by CMS as discouraging patients from using the dedicated emergency department may result in an EMTALA violation.</p>
			<p class="Body-Styles_Body-Text">California law also requires all hospitals providing licensed perinatal services to post a written notice in the obstetrical admitting area stating that the hospital does not maintain practices that result in different standards of obstetrical care based upon a patient’s source of payment or ability to pay for medical services. The notice must be posted in the predominant language or languages spoken in the service area of the hospital. CHA has adopted model signage for complying with the law; the model signage is set forth in Appendix P under “Obstetrical Care Notice.”</p>
			<p class="Body-Styles_Reference-Header"><span class="Reference-mark">F</span>&#9;References:</p>
			<p class="Body-Styles_References">42 C.F.R. Section 489.20(q) (Appendix B) </p>
			<p class="Body-Styles_References">59 Fed. Reg. 32086 (June 22, 1994)</p>
			<p class="Body-Styles_References"><span class="Italic">Interpretive Guidelines</span>, tag no. A-240<span class="No-break">2/C</span>-2402 (Appendix C)</p>
			<p class="Body-Styles_References">Health and Safety Code Sections 1256.2(a) and 1317.3(d) (Appendix D)</p>
			<p class="Body-Styles_Body-Text ParaOverride-2"><span class="CharOverride-2"><a id="_idTextAnchor004"></a>EXTRACT FROM PREAMBLE TO 1994 EMTALA REGULATIONS</span></p>
			<p class="Body-Styles_Body-Text ParaOverride-3"><span class="CharOverride-2">Appendix II — Posting of Signs</span></p>
			<p class="Body-Styles_Body-Text ParaOverride-3">Section 6018(a)(2) of the Omnibus Budget Reconciliation Act of 1989 (OBRA ‘89), effective July 1, 1990, requires hospitals and rural primary care hospitals with emergency departments to post signs which specify the rights (under section  1867 of the Social Security Act) of women in labor and individuals with emergency medical conditions to examination and treatment.</p>
			<p class="Body-Styles_Body-Text ParaOverride-3">To comply with these requirements:</p>
			<ul>
				<li class="Body-Styles_Bullet-List ParaOverride-6">At a minimum, the sign must specify the rights of unstable individuals with emergency conditions and women in labor who come to the emergency department for health care services;</li>
				<li class="Body-Styles_Bullet-List ParaOverride-6">It must indicate whether the facility participates in the Medicaid program;</li>
				<li class="Body-Styles_Bullet-List ParaOverride-6">The wording of the sign must be clear and in simple terms understandable by the population serviced.</li>
				<li class="Body-Styles_Bullet-List ParaOverride-6">Print the signs in English and other major languages that are common to the population of the area serviced;</li>
				<li class="Body-Styles_Bullet-List ParaOverride-6">The letters within the signs must be clearly readable at a distance of at least 20 feet or the expected vantage point of the emergency department patrons; and</li>
				<li class="Body-Styles_Bullet-List ParaOverride-6">Post signs in a place or places likely to be noticed by all individuals entering the emergency department, as well as those individuals waiting for examina- tion and treatment (e.g., entrance, admitting area, waiting room, treatment area).</li>
			</ul>
			<p class="Body-Styles_Body-Text ParaOverride-3">The sample on the following page, which may be adapted for your use, contains sufficient information to satisfy these requirements. It does not, however, satisfy the visibility requirement.</p>
			<p class="Body-Styles_Body-Text ParaOverride-3"><span class="CharOverride-2">Appendix III — It’s the Law! If You Have a Medical Emergency or Are in Labor</span></p>
			<p class="Body-Styles_Body-Text ParaOverride-3">You have the right to receive, within the capabilities of this hospital’s staff and facilities:</p>
			<ul>
				<li class="Body-Styles_Bullet-List ParaOverride-6">An appropriate Medical Screening Examination.</li>
				<li class="Body-Styles_Bullet-List ParaOverride-6">Necessary Stabilizing Treatment (including treatment for an unborn child) and if necessary.</li>
				<li class="Body-Styles_Bullet-List ParaOverride-6">An appropriate Transfer to another facility even if you cannot pay or do not have medical insurance or you are not entitled to Medicare or Medicaid.</li>
			</ul>
			<p class="Body-Styles_Body-Text ParaOverride-3">This hospital [doe<span class="No-break">s/d</span>oes not] participate in the Medicaid program.</p>
			<p class="Body-Styles_Body-Text ParaOverride-3">59 Fed. Reg. 32086 <span class="Italic">et seq.</span> (June 22, 1994)</p>
			<ol>
				<li class="Body-Styles_Header-1"><a id="_idTextAnchor005"></a>Posters About Opioids and Pain Management</li>
			</ol>
			<p class="Body-Styles_Body-Text">The Centers for Disease Control and Prevention (CDC) and the Centers for Medicare &amp; Medicaid Services (CMS) have developed a poster about pain management and opioids called “Safer, More Effective Pain Management.” In addition, CDC and the American Hospital Association (AHA) have developed a poster called “Prescription Opioids: What You Need to Know.” Hospitals and other health care providers may post these signs in areas that patients are likely to see them, including emergency department waiting areas. CMS has confirmed that posting these signs will not be considered an EMTALA violation (even if some patients may read them and be discouraged from accessing services). The CD<span class="No-break">C/C</span>MS poster may be found at <a href="https://www.cdc.gov/drugoverdose/pdf/Original-PatientPoster-Digital.pdf">https://www.cdc.go<span class="No-break">v/d</span>rugoverdos<span class="No-break">e/p</span>d<span class="No-break">f/O</span>riginal-PatientPoster-Digital.pdf</a>, and the CD<span class="No-break">C/A</span>HA poster may be found at <a href="http://www.aha.org/content/16/opiodneedtoknow.pdf">http://www.aha.or<span class="No-break">g/c</span>onten<span class="No-break">t/16/o</span>piodneedtoknow.pdf</a>. Posting these notices is completely voluntary.<span class="CharOverride-3"><span id="footnote-000-backlink"><a class="_idFootnoteLink _idGenColorInherit" href="EMTALA_Chap10_rebuild.html#footnote-000">1</a></span></span></p>
			<hr class="HorizontalRule-1" />
			<div class="_idFootnotes">
				<div id="footnote-000" class="_idFootnote">
					<p class="Body-Styles_Footnote-Style"><a class="_idFootnoteAnchor _idGenColorInherit" href="EMTALA_Chap10_rebuild.html#footnote-000-backlink">1</a>&#9;Email from David R. Wright, Director, Survey and Certification Group, Center for Clinical Standards and Quality, Centers for Medicare &amp; Medicaid Services to Karen Reeves, Vice President, Risk Management and Accreditation, South Carolina Hospital Association, Nov. 7, 2017.</p>
				</div>
			</div>
		</div>
		<div class="_idGenObjectLayout-1">
			<div id="_idContainer004" class="_idGenObjectStyleOverride-2">
			</div>
		</div>
		<div class="_idGenObjectLayout-1">
			<div id="_idContainer005" class="_idGenObjectStyleOverride-2">
			</div>
		</div>
	








		<!-- searchable content -->
		<div id="search-content"></div>










		<div id="search-modal">
			<div class="modal-btn-container">
				<button id="close-modal">&times;</button>
			</div>
			<div style="text-align: center;">
				<div class="group">      
					<input type="text" required id="search-input">
					<span class="highlight"></span>
					<span class="bar"></span>
					<label>Search</label>
			    </div>
			</div>
			<ul id="search-results"></ul>
		</div>


		<footer id="menu-bar-footer" class="triggered">
			<div>
				<!-- <a href="tp-previous-article://show">
					<div class="chev a-prev"></div>
					<span>Previous</span>
				</a> -->
				<div>
					<div class="alert alert-primary alert-bottom alert-dismissable">
						<strong>Previous Button</strong> Tap this to go back to the previous position in the same chapter
						<button type="button" class="close" data-dismiss="alert" aria-label="Close">
			    			<span aria-hidden="true" style="font-size:24px !important;">&times;</span>
			  			</button>
					</div>
					<a href="#" id="a-back" class="disabled">
						<div>
							<svg class="icon" height="512" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"><path d="M785.5961 258.6122c-118.9094-118.8885-293.3447-147.6859-438.3138-86.5384l-35.84-61.2101c-8.5473-14.6077-18.5156-20.062-34.9623-24.0953-17.1781-4.2423-36.2789 9.1115-44.6589 23.6147l-99.8504 202.5848c-8.3592 14.5032-10.5326 32.3291-1.9853 46.9368s25.2865 21.6712 42.2139 21.7548L383.7701 369.8939c16.9273 0.1045 31.2842-8.0875 39.6434-22.5698 8.3801-14.5032 8.2756-31.0335-0.2717-45.662l-32.7889-56.0274c112.4101-43.0707 244.9241-19.1425 336.1228 72.0562 123.4024 123.4024 124.1966 322.6854 1.7972 445.1056s-321.7032 121.6261-445.1056-1.7972c-29.4661-29.4661-51.7433-63.3208-67.2078-99.3698 0 0 2.4869-24.4715-22.4026-49.3401-16.4467-16.4467-43.0289-16.5512-59.3502-0.2299-27.857 27.8361-4.5976 57.8873-4.5976 57.8873 19.3933 54.7318 50.5731 106.3079 94.4588 150.1936 156.2958 156.2958 408.7432 157.3198 563.806 2.257S941.9128 414.9081 785.5961 258.6122z" /></svg>
						</div>
						<span>Return</span>
					</a>
				</div>
				<a href="tp-article-top://show">
					<div class="chev a-top"></div>
					<span>Top</span>
				</a>
				<a href="#" id="search-button">
					<div class="a-search">
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" class="icon" viewBox="0 0 20 20"><path d="M18.64 17.02l-5.31-5.31c.81-1.08 1.26-2.43 1.26-3.87C14.5 4.06 11.44 1 7.75 1S1 4.06 1 7.75s3.06 6.75 6.75 6.75c1.44 0 2.79-.45 3.87-1.26l5.31 5.31c.45.45 1.26.54 1.71.09.45-.36.45-1.17 0-1.62zM3.25 7.75c0-2.52 1.98-4.5 4.5-4.5s4.5 1.98 4.5 4.5-1.98 4.5-4.5 4.5-4.5-1.98-4.5-4.5z"></path></svg>
					</div>
					<span>Search</span>
				</a>
				<a href="tp-next-article://show">
					<div class="chev a-next"></div>
					<span>Next</span>
				</a>
			</div>
		</footer>

		<div class="alert alert-primary alert-top alert-dismissable">
			<strong>Back Button</strong> Tap this to go back to the previous chapter
			<button type="button" class="close" data-dismiss="alert" aria-label="Close">
    			<span aria-hidden="true">&times;</span>
  			</button>
		</div>

		<script>



			/**
			 *	function to conver html collection to array
			 */
			function colToArr( col ){
				var elems = []
				for( var i = 0; i < col.length; i++ )
					elems.push( col[i] )
				return elems;
			}




			/**
			 *	Search Modal
			 *
			 * 	- toggle the search modal
			 */
			function showSearchModal(e){

				var fromTop = window.pageYOffset;

				document.body.style.overflow = 'hidden';

				document.getElementById('search-modal').style.display = 'block'

				// clear the old highlights
				for(var i = 0; i < highElems.length; i++)
					highElems[i].className = ''


				setTimeout(function(){

					window.scrollTo(0, fromTop)

					document.getElementById('search-modal').style.opacity = '1'

				}, 20);
			}

			document.getElementById('search-button')
				.addEventListener('click', showSearchModal, false);

			function hideSearchModal(){

				document.getElementById('search-modal').style.opacity = '0'

				setTimeout(function(){

					document.body.style.overflow = 'initial';

					document.getElementById('search-modal').style.display = 'none'

					// clear the search content
					results.innerHTML = ''

					// clear the input
					searchInput.value = ''

				}, 300);
			}

			document.getElementById('close-modal')
				.addEventListener('click', hideSearchModal, false);



			/**
			 *	Search Content
			 *
			 * 	- 
			 */

			// cross ref str pieces
			var str1 = 'tp-collection://emergency%20medical%20treatment%20manual/Chap'
			var str2 = '-EMTALA2020'

			// search subject
			// var searchContent = document.getElementById('search-content')

			// search input
			var searchInput = document.getElementById('search-input')

			// results list
			var results = document.getElementById('search-results')

			// array of all the list items
			var lis = []

			// the current search term
			var searchTerm = ''

			var chap;






			/**
			 *	find child nodes
			 *
			 */

			// the objects

			function dfsTreeToList(elem, arr, lastID){

				// loop through all the children
				for( var i = 0; i < elem.childNodes.length; i++ ){

					// if this is a text node
					if(elem.childNodes[i].nodeType === 3){

						// arr.push(elem.childNodes[i].nodeValue)
						if(arr.hasOwnProperty(lastID)){
							arr[lastID] = arr[lastID] + elem.childNodes[i].nodeValue
						}else{
							arr[lastID] = elem.childNodes[i].nodeValue
						}

					}
					// else 
					if(  elem.childNodes[i].nodeType == 1  && elem.childNodes[i].hasAttribute('id') && elem.childNodes[i].id.indexOf('_idTextAnchor') > -1 ){ 

						lastID = elem.childNodes[i].id
					}
					// call the function again with the child node
					dfsTreeToList( elem.childNodes[i], arr, lastID  )
				}
				return arr;
			}

			scElem = document.getElementById('search-content')

			searchContent = {}

			// loop through all the chapters
			for(var i = 0; i < scElem.children.length; i++){

				searchContent[scElem.children[i].dataset.chapter] = dfsTreeToList(scElem.children[i], {}, '')

			}




			/**
			 *	search link section
			 *
			 *  - set the localStorage anchor
			 *  - navigate to the page
			 */

			var navId = ''

			function searchLink(e){ e.preventDefault()

				// if the link is in the current chapter
				if( currChap == this.dataset.href ){

					// set the nav id
					navId = this.dataset.anchor

					// set a timeout to scroll to view
					setTimeout(function(){

						prevLocs.push( window.pageYOffset )

						// go directly the section
						document.getElementById(navId).scrollIntoView();

						// then scroll to center and highlight
						highlightText( document.getElementById(navId), searchTerm )

					}, 350)

					// close the search modal
					hideSearchModal();

					return;
				}

				// set localStorage
				localStorage.setItem('anchor', this.dataset.anchor)
				localStorage.setItem('searchterm', searchTerm)

				// navigate to the link
				window.location.href = this.href
			}

			var myInter;


			function findShit(){

				// set the global searchTerm variable
				searchTerm = this.value

				var	filter = this.value.toUpperCase()

				clearInterval(myInter)

				// clear the results
				results.innerHTML = ''

				// if the value is empty, do nothing
				if( this.value.length == 0 ) return;

				myInter = setInterval(function(){
				
					helperLoop2(filter, searchContent)

				}, 400)
			}

			function helperLoop2(filter, searchContent){

				var indexOfVal = -1
				var txtValue = ''

				// loop through the chapters
				for(var x in searchContent){

					// loop through the sections
					for( var y in searchContent[x] ){

						// get the index of the matching text
						indexOfVal = searchContent[x][y].toUpperCase().indexOf( filter )

						if( indexOfVal > -1 ){

							txtValue = searchContent[x][y].slice( indexOfVal, indexOfVal + 200 )

							createResultsElem2( x, y, txtValue )

						}
					}
				}

				clearInterval(myInter)
			}

			/**
			 *	create new result element
			 *
			 */
			function createResultsElem2( chap, anchor, txtValue ){

				if(!anchor) return;

				var resultElem = document.createElement('li')
				resultElem.innerHTML = 
					'<a href="'+ str1 + addLeading0(chap) + str2 +'" data-href="'+addLeading0(chap)+'" data-anchor="'+anchor+'">' + 
						'<span class="result-ch">Ch ' + chap + '</span>' +
						'<div class="result-text">' + txtValue + '</div>' +
					'</a>'
				// add the event listener
				resultElem.children[0].addEventListener('click', searchLink, false)
				results.appendChild( resultElem )
			}

			/**
			 *	- find the text in the section
			 *	- highlight it
			 *
			 *	@ anchorElem - the <a> tag with the id
			 *  @ searchTerm - str
			 */


			function textNodesUnder(node){
			  var all = [];
			  for (node=node.firstChild;node;node=node.nextSibling){
			    if (node.nodeType==3) all.push(node);
			    else all = all.concat(textNodesUnder(node));
			  }
			  return all;
			}

			// keep a list of all the highlight elements
			var highElems = []

			function highlightText( anchorElem, searchTerm ){

				var section;

				// clear the high elems
				highElems = []			

				// if the anchor elem is a header 1, do nothing
				if( anchorElem.parentElement.className == 'Body-Styles_Header-1' ){
					
					// loop through the children
					var cNodes = anchorElem.parentElement.childNodes
					for( var i = 0; i < cNodes.length; i++ ){

						// if the node is not an ol
						if( cNodes[i].nodeType == 1 && cNodes[i].tagName == 'OL' ) continue;

						var cni = textNodesUnder( cNodes[i] )

						// get the nodes for each of these children if they are not OL tags
						if( cni.length )
							highlightHelper( cni )
					}

					return;
				}
				
				// get the section
				section = anchorElem.parentElement.tagName == 'LI' ?
							anchorElem.parentElement :
							anchorElem.parentElement.parentElement ;

				// highlight the child nodes
				highlightHelper( textNodesUnder( section ) );
			}

			/**
			 *	highlight the elmes
			 *
			 */
			function highlightHelper( nodes ){

				// loop through the child nodes
				for( var i = 0; i < nodes.length; i++ ){

					var nVal = nodes[i].nodeValue

					// find the position of the search term
					var j = nVal.toUpperCase().indexOf( searchTerm.toUpperCase() )

					// if the term is found
					if( j > -1 ){

						// create the first text node
						var tn1 = document.createTextNode( nVal.substr(0, j) );

						// create the second text node
						var tn2 = document.createTextNode( nVal.substr( j +searchTerm.length ) )

						// create the highlight span
						var hSpan = document.createElement('span')
						hSpan.className = 'highlighter'
						hSpan.innerHTML = nVal.substr(j, searchTerm.length)
						// push it onto the array
						highElems.push( hSpan )


						// append all the children
						nodes[i].parentElement.insertBefore( tn1, nodes[i] )
						nodes[i].parentElement.insertBefore( hSpan, nodes[i] )
						nodes[i].parentElement.insertBefore( tn2, nodes[i] )
						nodes[i].parentElement.removeChild( nodes[i] )
					}
				}

				if( highElems.length )
					scrollToText( highElems[0] )
			}



			/**
			 * - scroll to highlighted text
			 *
			 */
			function scrollToText( elem ){

				// if the highlight is greater than 25% down the page
				var distanceFromTop = elem.getBoundingClientRect().top
				if( distanceFromTop / window.innerHeight > .25 || distanceFromTop / window.innerHeight < 0){

					// get the distance to 25%
					var scrollPos = distanceFromTop - (window.innerHeight * .25)
					scrollPos = window.scrollY + scrollPos
					setTimeout(function(){
						window.scrollTo({
							top: scrollPos,
							behavior: 'smooth'
						})
					}, 50)
				}
			}

			searchInput.addEventListener('keyup', findShit, false)







			/**
			 *	fix the cross ref links
			 */

			// function to add a leading 0 to single digit numbers
			function addLeading0( int ){
				if( 0 < int && int < 10 )
					return '0' + int;
				return int;
			}

			// function to add the alert in localStorage
			function storeSectionTitle(e){ e.preventDefault()

				localStorage.setItem('xref', this.dataset.title )

				window.location.href = this.href
			}

			// get the next button
			var nextButton = document.querySelector('.a-next').parentElement

			// get the current chapter
			var currChap = parseInt( document.querySelectorAll('.Chapter-number')[1].innerHTML )

			// wrapping this in a function to for more async loading
			function fixCrossRef(){

				if( currChap == '20' ){
					// remove the next button
					nextButton.parentElement.removeChild( nextButton )
				}else{
					nextButton.href = str1 + addLeading0( currChap + 1 ) + str2
				}

				// loop through all the blank hrefs
				var crossRefs = document.getElementById('_idContainer003').querySelectorAll('[href=""]');
				for( var i = 0; i < crossRefs.length; i++ ){

					// if this is a legit cross ref link
					if( crossRefs[i].children.length > 1 ){

						// remove the page number but keep the chapter
						var myItalic = crossRefs[i].querySelectorAll('.Italic');
						myItalic = myItalic[ myItalic.length - 1 ]
						// console.log(myItalic)
						var chap = myItalic.innerHTML = myItalic.innerHTML.split('.')[0]

						// get the inner HTML
						var title = crossRefs[i].innerHTML

						// get everything after the first quote and before the comma
						title = title.split('"')[1]
						title = title.split(',')[0]; console.log(title)
						crossRefs[i].setAttribute('data-title', title)

						// get the chapter
						// var chap = crossRefs[i].children[ crossRefs[i].children.length - 1 ].innerHTML
						// chap = chap.split('.')[0]

						// // set the href
						crossRefs[i].href = str1 + addLeading0( chap ) + str2

						// replace "page" with chapter
						crossRefs[i].innerHTML = crossRefs[i].innerHTML.replace('page&nbsp;', 'Chapter&nbsp;')

						// remove the page number
						// title = crossRefs[i].innerHTML; console.log(title);
						// title = title.split(',"')[0]
						// title = title + '"</span>'
						// crossRefs[i].innerHTML = title

						// // add the event listener
						crossRefs[i].addEventListener('click', storeSectionTitle, false)
					}
				}
			}

			/**
			 *	display the cross reference on page load
			 *
			 */
			function displayCrossRef(){

				// get the cross reference
				var crossRef = localStorage.getItem('xref')

				// if we were NOT refered to this page by a cross reference
				if( crossRef == null ) return; //do nothing

				// get all the table of contents
				var tocs = document.getElementById('_idContainer001')
							.querySelectorAll('a')

				// loop through those bitches
				for( var i = 0; i < tocs.length; i++ ){

					// if the toc entry contains the title text
					if( tocs[i].innerHTML.indexOf( crossRef ) > -1 ){

						// console.log(document.getElementById( tocs[i].dataset.href ))

						var myId = tocs[i].dataset.href

						setTimeout(function(){

							document.getElementById( myId ).scrollIntoView()

						}, 100)

						break;
					}
				}

				localStorage.removeItem('xref')
			}










			/**
			 *	window scroll
			 *
			 * 	- keep track of the current location on the page
			 */
			window.currLoc = 0 
			window.prevLocs = []
			window.nextLocs = []

			function getCurrLoc(){

				this.currLoc = window.pageYOffset;
			}

			window.addEventListener('scroll', getCurrLoc, false)

			/**
			 *	- highjack all the anchor tags
			 *
			 */
			function setLocs(e){ e.preventDefault()

				// remove the scroll event listener
				window.removeEventListener('scroll', getCurrLoc, false)

				// if the current scroll position has not already been added to the prevLocs array
				// if( window.currLoc != -1 ){

				// 	// add it
				// 	prevLocs.push( window.currLoc )

				// 	// set it to -1
				// 	window.urrLoc = -1
				
				// }else{

					// add this current position to the array
				prevLocs.push( window.pageYOffset )
				// }

				// clear the nextLocs 
				// nextLocs = []

				// enable the back button
				backBtn.className = ''

				// disable the forward button
				// forwardBtn.className = 'disabled'

				// go to that anchor
				document.getElementById( this.dataset.href ).scrollIntoView()
			}

			var aTags = document.getElementById('_idContainer001').getElementsByTagName('A')

			// loop through the tags
			for( var i = 0; i < aTags.length; i++ ){

				// if the a tag is an anchor
				if( aTags[i].href.indexOf('#') > -1 ){

					aTags[i].setAttribute('data-href', aTags[i].href.split('#')[1] )

					// add the set Loc event listener
					aTags[i].addEventListener('click', setLocs, false)
				}
			}

			var aTags = document.getElementById('_idContainer003').getElementsByTagName('A')
			// console.log(aTags)

			// loop through the tags
			for( var i = 0; i < aTags.length; i++ ){

				// if the a tag is an anchor
				if( aTags[i].href.indexOf('#') > -1 ){

					aTags[i].setAttribute('data-href', aTags[i].href.split('#')[1] )

					// remove the page number
					// aTags[i].innerHTML = aTags[i].innerHTML.split(',"')[0] + '"</span>'

					// get the last Italic class span and remove the page number
					var lastSpan = aTags[i].querySelectorAll('.Italic')
					if(lastSpan.length){
						lastSpan = lastSpan[ lastSpan.length - 1 ]
						lastSpan.innerHTML = lastSpan.innerHTML.split('.')[0]
					}

					// change page to chapter
					aTags[i].innerHTML = aTags[i].innerHTML.split('page')[0] + '</span>'

					aTags[i].innerHTML = aTags[i].innerHTML.replace(',"', '"')

					// add the set Loc event listener
					aTags[i].addEventListener('click', setLocs, false)
				}
			}



			/**
			 *	back button
			 *
			 */
			var backBtn = document.getElementById('a-back')

			backBtn.addEventListener('click', function(e){ e.preventDefault()

				var loc = prevLocs.pop()

				window.scrollTo( 0, loc )

				// push it to the forward array
				nextLocs.push( loc )

				// enable the forward button
				// forwardBtn.className = ''

				// maybe disable the back button
				if( !prevLocs.length ){

					backBtn.className = 'disabled'
				}

			}, false)










			/**
			 *	sticky footer nav
			 */
			window.lastScrollTop = 0;
			window.trigFoot = document.getElementById('menu-bar-footer')
			// element should be replaced with the actual target element on which you have applied scroll, use window in case of no target element.
			window.addEventListener("scroll", function(){ // or window.addEventListener("scroll"....
			   var st = this.pageYOffset || document.documentElement.scrollTop; // Credits: "https://github.com/qeremy/so/blob/master/so.dom.js#L426"
			   if (st > this.lastScrollTop){
			      this.trigFoot.className = ''
			   } else {
			      this.trigFoot.className = 'triggered'
			   }
			   this.lastScrollTop = st <= 0 ? 0 : st; // For Mobile or negative scrolling
			}, false);








			/**
			 *	UI helper
			 *
			 */
			var alertTop = document.querySelector('.alert-top')
			var alertBottom = document.querySelector('.alert-bottom')

			// add the close event listener
			alertTop.querySelector('.close').addEventListener('click', function(){
				displayUI(alertBottom)
				var par = this.parentElement
				par.style.opacity = '0'
				setTimeout(function(){
					par.parentElement.removeChild(par)
				}, 250)
			}, false)

			alertBottom.querySelector('.close').addEventListener('click', function(){
				var par = this.parentElement
				par.style.opacity = '0'
				setTimeout(function(){
					par.parentElement.removeChild(par)
				}, 250)
			}, false)

			function uiHelper(){

				// if the trigger is already triggered, do nothing
				if( localStorage.getItem('uihelper') ) return;

				// set the trigger
				localStorage.setItem('uihelper', true)

				// display the first element
				displayUI( alertTop )

			}

			function displayUI( elem ){

				elem.style.display = 'block'

				var elem = elem

				setTimeout(function(){
					elem.style.opacity = '1'
				}, 50)
			}










			/**
			 * get the external links
			 *
			 */
			var xternalRefs = document.getElementById('_idContainer003')
								.querySelectorAll('a')

			// loop through those bitches
			for(var i = 0; i < xternalRefs.length; i++){

				// if this is an external link
				if( xternalRefs[i].href.indexOf('http') > -1 ){

					xternalRefs[i].setAttribute('target', '_system')
				}
			}








			
			/**
			 *	get the last ordered list of a root level elem
			 *
			 *	used primarily on the prev variable
			 */
			function getLastOl( masterList ){

				// get the last L1
				var lastElem = masterList.children[ masterList.children.length - 1]

				// get the last child of the last L1
				lastElem = lastElem.children[ lastElem.children.length - 1 ]

				// if the last child is an OL with h2 elems
				if( lastElem.tagName == 'OL' && lastElem.children[0] !== 'undefined' && lastElem.children[0].className.indexOf('Body-Styles_Header-2') > -1 ){

					// return level 2 list
					return lastElem;

				}

				// else return the masterList
				return masterList;
			}



			/**
			 *	navigate to the anchor
			 */
			function navToAnchor(){ 

				if( localStorage.getItem('anchor') == null ) return;

				setTimeout(function(){

					// navigate to the section
					document.getElementById( localStorage.getItem('anchor') ).scrollIntoView()

					// if there is a search term
					if( localStorage.getItem( 'searchterm' ) ){
						searchTerm = localStorage.getItem( 'searchterm' )
						highlightText( document.getElementById( localStorage.getItem('anchor') ), searchTerm )

						localStorage.removeItem('searchterm')
					}

					// clear the localStorage
					localStorage.removeItem('anchor')


				}, 50)
			}

			/**
			 *	tag patrol
			 */
			function tagPatrol( elems ){

				// master list
				var masterList = elems.shift()

				if( masterList.tagName != 'OL' ){
					tagPatrol( elems )
					return;
				}

				// loop through all the elems
				while( elems.length ){

					var curr = elems.shift()

					var lastOl = getLastOl( masterList )

					// if curr is an h1 list
					if( curr.tagName == 'OL' && curr.children[0].className.indexOf('Body-Styles_Header-1') > -1){

						// loop through the children
						while( curr.children.length ){

							// append them to the master list
							masterList.appendChild( curr.children[0] )
						}
					}

					// if curr is an h2 list
					else if( curr.tagName == 'OL' && curr.children[0].className.indexOf('Body-Styles_Header-2') > -1  ){

						// if the last OL is a L1
						if( lastOl === masterList ){

							// append the whole list to the last list item
							masterList.children[ masterList.children.length - 1 ].appendChild( curr )
						}

						// else if the last OL is l2
						else{

							// loop through the curr list
							while( curr.children.length ){

								// append them to the last ol
								lastOl.appendChild( curr.children[0] )
							}
						}
					}

					// if this is any other element, append it to the last li of the last ol
					else{

						lastOl.children[ lastOl.children.length - 1 ].appendChild( curr )
					}
				}

				// navigate to the proper section if requested
				navToAnchor();
			}

			/**
			 *	initalize
			 */
			document.addEventListener('DOMContentLoaded', function(){ 
				
				tagPatrol(
					colToArr(
						document.getElementById('_idContainer003').children
					)
				)

				// navToAnchor();

				fixCrossRef()

				setTimeout(function(){ displayCrossRef(); }, 1000);

				// display the UI helper
				uiHelper();

			}, false);
		</script>
	</body>
</html>		





